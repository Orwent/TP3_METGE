### Configuration de l'installation automatisée ###

# Localisation (Installation en français avec clavier AZERTY)
d-i debian-installer/locale string fr_FR
d-i console-keymaps-at/keymap select fr
d-i keyboard-configuration/xkb-keymap select fr(latin9)

# Configuration réseau (interface automatique et hostname par défaut)
d-i netcfg/choose_interface select auto
d-i netcfg/get_hostname string debian
d-i netcfg/get_domain string localdomain

# Configuration du miroir Debian
d-i mirror/country string manual
d-i mirror/http/hostname string deb.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Partitionnement automatique (Partitionnement classique)
d-i partman-auto/method string regular
d-i partman-auto/choose_recipe select atomic
d-i partman/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true

# Configuration des utilisateurs
# Mot de passe root
d-i passwd/root-password password root
d-i passwd/root-password-again password root

# Comptes utilisateurs supplémentaires
# Exemple d'utilisateur 1
d-i passwd/user-fullname string User1
d-i passwd/username string user1
d-i passwd/user-password password password1
d-i passwd/user-password-again password password1

# Exemple d'utilisateur 2
d-i passwd/user-fullname string User2
d-i passwd/username string user2
d-i passwd/user-password password password2
d-i passwd/user-password-again password password2

# Désactivation de la création d'un utilisateur standard par défaut
d-i passwd/make-user boolean false

# Installation d'OpenSSH Server (SSHD)
d-i pkgsel/include string openssh-server

# Ajout de fichiers personnalisés et commandes post-installation
d-i preseed/late_command string \
    echo "Hello World" > /target/home/helloworld.txt; \
    echo "alias l='ls -la'" >> /target/root/.bashrc; \
    echo "alias l='ls -la'" >> /target/etc/skel/.bashrc; \
    echo "export PS1='\u@\h \[\033[01;34m\]\w\[\033[00m\] \$ '" >> /target/etc/skel/.bashrc; \
    chmod 644 /target/home/helloworld.txt;

# Installation du chargeur de démarrage GRUB
d-i grub-installer/only_debian boolean true
d-i grub-installer/bootdev string /dev/sda

# Fin de l'installation
d-i finish-install/reboot_in_progress note
